#
# BUILD COMMAND: VERSION=0.0.1 && sudo DOCKER_BUILDKIT=1 docker build --build-arg version=$VERSION -t usdotfhwastoldev/voices:base-$VERSION . --progress=plain -f base_Dockerfile
#

FROM ubuntu:20.04 as build

RUN apt update && \
    apt install -y python3-pip

RUN pip3 install gdown

WORKDIR /home

RUN gdown --id 10RaCptmxrcWPoEgWsPy8I2DrBeVWsnEG
    
RUN gdown --id 17UovGmLGn7VPo4vUNAw5dh7Po_Y_Ukx-

RUN chmod a+x ./*.bin

RUN /home/TENA-MiddlewareSDK-v6.0.8.B@Product@u2004-gcc9-64-*.bin -i /home/ --auto && \
/home/VUG-Combined-Distribution-*.bin -i /home/ --auto && \
# /home/BUILD/VUG-Combined-DataCollectionDistribution-*.bin -i /home/ --auto && \
rm -rf /tmp/*

FROM ubuntu:20.04

COPY --from=build /home/TENA /home/TENA

LABEL version="0.0.1"
LABEL description="Base VOICES Docker image with base tena installation"

SHELL ["/bin/bash", "-ec"]

USER root
ARG DEBIAN_FRONTEND="noninteractive" 
ARG TZ="America/New_York"
ARG USER="root"

WORKDIR /home

# INSTALL TENA bin

# RUN /home/BUILD/TENA-MiddlewareSDK-v6.0.8.B@Product@u2004-gcc9-64-*.bin -i /home/ --auto && \
#     /home/BUILD/VUG-Combined-Distribution-*.bin -i /home/ --auto && \
#     # /home/BUILD/VUG-Combined-DataCollectionDistribution-*.bin -i /home/ --auto && \
#     rm -rf /tmp/*

